<!DOCTYPE html>
<html lang="en">
<head>
    <title>axkralj990</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="sidebar.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
</head>
<body style="padding-top: 70px;">

	<nav class="navbar navbar-inverse navbar-fixed-top">
    	<div class="container">

        	<!-- navbar header -->
            <div class="navbar-header">
        		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#mainNavBar">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                </button>
            	<a href="http://axkralj990.github.io/" class="navbar-brand">AXKRALJ990</a>
            </div>

            <!-- menu -->
            <div class="collapse navbar-collapse" id="mainNavBar">
            	<ul class="nav navbar-nav">
                	<li><a href="http://axkralj990.github.io/">Home</a></li>
                    	<li><a href="about_me.html">About Me</a></li>
                    	<!-- drop down menu -->
                    	<li class="dropdown active">
                    		<a href="#" class="dropdown-toggle" data-toggle="dropdown">Projects<span class="caret"></span></a>
                        	<ul class="dropdown-menu">
                        		<li><a href="quad.html">ATmega Quadcopter</a></li>
                   			<li><a href="SGM_cs.html">Serial Grahing Monitor - C#</a></li>
                            		<li><a href="SGM_python.html">Serial Graphing Monitor - Python</a></li>
                   			<li><a href="AVR_misc.html">Smaller AVR Projects</a></li>
                        	</ul>
                    	</li>
			<li><a href="https://github.com/axkralj990">GitHub Page</a></li>
                </ul>
            </div>
    	</div>
    </nav>

	<div class="container">
    <div class="row">
      <div class="col-md-8">
    <!--<div class="row">-->
    <p>In my senior year of aerospace engineering I got really interested into control systems and airplane stability and control. Since then I've had this desire to design my own
    flight controller. Quadcopters interested me the most, since they are unstable and pretty much useless without a closed-loop controller. After learning how to program the AVR
  I got the idea to write the flight controller on the ATmega328P chip. This is the same chip Arduino Uno uses. The reason I chose to write the controller diretly on the chip using
C instead of using an Arduino, was that I wanted to gain as much knowledge as possible in writing firmware for embedded systems and Arduino environment hides much of the
low-level functions by making the enviroment more user-friendly. I still think that Arduino is a great tool for learning microcontrollers, but gaining a deeper insight into how the
microcontoller actually work is a necessary step forward for whoever wants to learn and get more from their microcontrollers.</p>

<p>When I started programming AVR everything seemed really hard and far from being as user-friendly as Arduino. First thing that scared me was that 660 page long Atmel's user manual
is something that you need to refer to the whole time you are programming the chip. But after patiently sticking with it for some time it became much more friendly,
as a matter of fact I feel more comfotable programming AVR than Arduino now. I must say that
 <a href="http://www.littlehacks.org/avr-programming">Elliot Williams' book AVR Programming</a> helped me the most to break that barrier. Having direct access to microcontrollers registers
 gives so much more functionality to the chip that switching back to Arduino makes it harder to work with functions that hide some of the information required for some appilications.</p>

<p>In this project I will cover many different topics that are required for the quad flight controller. I will cover using the analog to digital converter for scanning the flight battery level,
, I2C (TWI) communication between the MPU6050 inertial measurement unit and the ATmega328, using the timers for time measurement required for reading and writing RC signals and PID control,
EEPROM for storing configuration data, USART for configuration and debugging, and much more. As you can see quite many topics need to be covered in order to write the flight
controller, that's why I made a separate repository where I upload programs where I learned about each one of these modules. <a href="AVR_misc.html">This page</a> goes into detail for each one of the modules.</p>

<p>The controller design was greatly inspired by Joop Brokking's <a href="http://www.brokking.net">Youtube channel</a> and <a href="https://www.youtube.com/user/MacPuffdog/featured">blog</a>.
I find his YMFC-3D quadcopter video tutorials of great help and I will refer to them often during the project. The quad components are also almost the same as on the YMFC-3D.</p>

<p>I have also used many libraries from other Github users. All references to the authors are under each subsection of the project where the specific library is used.</p>

<a name="serialMonitor"></a>
<p>As soon as I started reading about mesuring the orientation in space with MPU6050 IMU, I realized
  I needed to make a program that will graph the data sent from the microcontroller via serial port to the computer.
  For that reason I wrote a <a href="#csharp">serial graphing monitor in C#</a>.
  At first I wrote the <a href="#python">serial graphing monitor in Python 2.7</a>, but I got the desire to learn C# later, so I wrote another one. Both serial graphing programs are described
under projects section</p>
    </div>
    <div class="col-md-4">
      <div class="panel panel-default">
        <div class="panel-heading">Contents</div>
        <div class="panel-body">
          <ol>
            <li><a href="quad.html">Overview</a></li>
            <li><a href="#serialMonitor">Serial Graphing Monitor</a></li>
            <li><a href="#">ATmega328 Microcontroller</a></li>
            <li><a href="#">Orientation Sensing</a></li>
            <li><a href="#">RC control</a></li>
            <li><a href="#">Quadcopter components</a></li>
            <li><a href="#">Firmware Architecture</a></li>
            <li><a href="#">Hardware Design</a></li>
            <li><a href="#">Controller Setup</a></li></a></li>
            <li><a href="#">Future Improvements</a></li>
          </ol>
        </div>
      </div>
    </div>
    </div>

    <a name="python"></a>

<h2>Serial Graphing Monitor</h2>

<p>Descriptions of both serial graphing monitors are on the following pages.</p>
<ul>
  <li><a href="SGM_cs.html">Serial Graphing Monitor - C#</a></li>
  <li><a href="SGM_python.html">Serial Graphing Monitor - Python</a></li>
</ul>

<div class="row" style="padding-bottom: 30px;">
  <div class="col-md-6">
  <img src="Monitor.jpg" height="500">
  </div>

  <div class="col-md-6">
    <img src="MonitorC.JPG" height="500">
  </div>
</div>

<div class="row">
<h2>Libraries for ATmega328 and Arduino</h2>
<p><h3>1. AK_MPU6050_lib for ATmega328: </h3> I am working on a library to use MPU6050 IMU with ATmega328P chip. As of September 19, 2016 the library contains the following functions:</p>

<ul>
  <li>MPU6050_init()</li>
  <li>MPU6050_test_I2C()</li>
  <li>MPU6050_get_accel()</li>
  <li>MPU6050_get_gyro()</li>
  <li>MPU6050_set_sleepMode()</li>
  <li>MPU6050_set_gyroFS()</li>
  <li>MPU6050_set_accelFS()</li>
  <li>MPU6050_set_clockSource()</li>
</ul>

<p>The AK_MPU6050_lib uses <a href="https://github.com/g4lvanix/I2C-master-lib">I2c-master-lib by g4lvanix</a> for I2C communication with the MPU6050 chip.</p>

<h3>2. USART library for ATmega328: </h3>

<p>This is a slightly modified version of a USART library written by Elliot Williams for his <a href="http://www.littlehacks.org/avr-programming">AVR Programming book</a>. I must note that I have learned most of my AVR programming knowledge from this book and I highly recommend it.</p>

<h2>Quadcopter Components</h2>

<p>I have finally received all the components for the quad. I bought almost everything from <a href="http://www.brokking.net/ymfc-al_main.html">Brokking's list</a> for his YMFC-3D AL quadcopter. Links to each part at dx.com are on his website. The only thing I bought in my local RC store was the LiPo charger and the batttery, since LiPo batteries could not be shipped to EU from dx.net.</p>

<p>First problem I ran into was that I had no idea on how to work with LiPo batteries, since they be quite dangerous if not handled properly. <a href="http://www.tjinguytech.com/charging-how-tos">This link</a> taught me all I needed for now.</p>

<p>I have also bought all the miscallaneous components, such as heat-shrink tubes, various cables, etc. I will be posting the complete parts list soon.</p>

<p>Author: alex.kraljic@gmail.com</p>

<p>There is still a lot to fix, add, and improve, so any suggestions and corrections are welcome!</p>
</div>
<!--</div>-->
	<hr>
      <footer>
        <p>&copy; 2016 Company, Inc.</p>
      </footer>
    </div> <!-- /container -->
</body>
</html>
